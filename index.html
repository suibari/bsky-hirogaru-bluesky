<!DOCTYPE html>
<meta charset="utf-8">

<head>
<script src="https://cdnjs.cloudflare.com/ajax/libs/cytoscape/3.28.1/cytoscape.min.js"></script>

<style>
    body, html {
        margin: 0;
        padding: 0;
        width: 100%;
        height: 100%;
    }
    #cy {
        width: 100%;
        height: 100%;
        position: absolute;
    }
</style>
</head>

<body>

<button id="fetchButton">Fetch Data</button>
<div id="cy"></div>

<script>

var cy = window.cy = cytoscape({
    container: document.getElementById('cy'), // container to render in
    
    // layout: {
    //     name: 'cose',
    // },
    
    style: [
        {
            selector: 'node',
            style: {
                'width': 20,
                'height': 20,
                'background-fit': 'contain',
                'background-image': 'data(img)',
                'label': 'data(name)',
                'background-image-crossorigin': "null",
            }
        },
        {
            selector: 'edge',
            style: {
                'width': 3,
            }
        }

    ]
});

const fetchButton = document.getElementById('fetchButton');
fetchButton.addEventListener('click', async () => {
    try {
        const response = await fetch('/data', {
            headers: {
                'Content-Type': 'application/json'
            }
        });
        const data = await response.json();
        cy.add(data);
        cy.layout({
            // cose ---
            name: 'cose',
            animate: 'false',
            nodeOverlap: 1,
            nodeRepulsion: function( node ){ return 1e7; },
            // cola ---
            // name: 'cola',
            // animate: false,
        }).run();
    } catch (error) {
        console.error('Error fetching data:', error);
    }
});

</script>

</body>